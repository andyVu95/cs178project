import numpy as np
import matplotlib.pyplot as plt
import mltools as ml

X = np.genfromtxt("data/X_train.txt",delimiter=None)
Y = np.genfromtxt("data/Y_train.txt",delimiter=None)
Xtest = np.genfromtxt("data/X_test.txt",delimiter=None)

Xt, Xv, Yt, Yv = ml.splitData(X,Y, 0.80)

M = Xt.shape[0]
Mv = Xv.shape[0]

Xi, Yi = ml.bootstrapData(Xt,Yt, M)
forest = ml.dtree.treeClassify()
forest.train(Xi,Yi,maxDepth=15, minLeaf=4, nFeatures=5)

Yhat = forest.predictSoft(Xtest)

np.savetxt('Yhat_dtree.txt',
          np.vstack((np.arange(len(YhatTr)), YhatTr[:,1])).T, '%d, %.2f',
           header='ID,Prob1', comments='',delimiter=',');
