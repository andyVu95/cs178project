import numpy as np
import matplotlib.pyplot as plt
import mltools as ml

X = np.genfromtxt("data/X_train.txt",delimiter=None)
Y = np.genfromtxt("data/Y_train.txt",delimiter=None)
Xtest = np.genfromtxt("data/X_test.txt",delimiter=None)

Xt, Xv, Yt, Yv = ml.splitData(X,Y, 0.80)

from sklearn.neighbors import KNeighborsClassifier

knn = KNeighborsClassifier(n_neighbors=40)
knn.fit(Xt,Yt)
Yhat = knn.predict_proba(Xtest)

np.savetxt('Yhat_knn.txt',
          np.vstack((np.arange(len(Yhat)), Yhat[:,1])).T, '%d, %.2f',
           header='ID,Prob1', comments='',delimiter=',');
